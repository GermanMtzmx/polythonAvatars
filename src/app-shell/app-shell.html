<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">

<link rel="import" href="../../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">

<!-- local imports -->
<link rel="import" href="../app-login/app-login.html">
<link rel="import" href="../app-notfound/app-notfound.html">
<link rel="import" href="../app-home/app-home.html">
<link rel="import" href="../app-verification/app-verification.html">

<link rel="import" href="../style-foundation/app-theme.html">


<dom-module id="app-shell">
    <template>
        <style>
            #header {
                @apply --toolbar-theme;
            }
        </style>
        
        <app-location route="{{route}}"></app-location>

        <app-route 
            route="{{route}}"
            pattern="/:page"
            data="{{routeData}}"
            tail="{{subroute}}"
        ></app-route>

        <app-header id="header" role="navigation" shadow$="[[isLogged]]">
            <app-toolbar class="toolbar">
                <template is="dom-if" if="[[isLogged]]">
                     <paper-icon-button id="previous" icon="icons:arrow-back"></paper-icon-button>                
                </template>
            </app-toolbar>
        </app-header>

        <iron-pages 
            role="main"
            attr-for-selected="id"
            selected="[[page]]"
            fallback-selection="notfound"
        >
            <app-login id="login"></app-login>
            <app-home id="home"></app-home>
            <app-notfound id="notfound"></app-notfound>
            <app-verification id="verification"></app-verification>
            
        </iron-pages>
    </template>


    <script>
        (function Shell(customElements){
            'use strict';

            class AppShell extends Polymer.Element {
                static get is(){ return 'app-shell'; }

                static get properties(){
                    return {
                        route:{
                            type:Object,
                            value:{}  
                        },

                        subroute:{
                            type:Object,
                            value:{}
                        },

                        routeData:{
                            type:Object,
                            value:{}
                        },

                        page:{
                            type:String
                        },

                        isLogged:{
                            type:Boolean,
                            value:false
                        }                     
                    }                    
                }

                static get observers(){
                    return [
                        '_routePageChanged(routeData.page)'
                    ]
                }

                _routePageChanged(page){
                    this.page = page || 'login';
                    console.log(this.page)
                   if (this.page != 'login'){
                    this.isLogged = true
                   }
                }
            }

            customElements.define(AppShell.is, AppShell);
        })(window.customElements);
    </script>
</dom-module>